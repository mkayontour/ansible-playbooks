me: manage packages on windows
  hosts: all
  vars:
    action_triggered: null 
    msi_arguments: null
  tasks:

    - name: "uninstall package {{ windows_package_path }}"
      win_package:
        path: "{{ windows_package_path }}"
        arguments: 
          - /quiet
          #"{{ msi_arguments | list }}"
      when: ( windows_package_path is defined and action_triggered == "uninstall" ) or
        ( windows_package_path is defined and action_triggered == "reinstall" )

    - name: "install package {{ windows_package_path }}"
      win_package:
        path: "{{ windows_package_path }}"
        arguments: 
          - /quiet
          #"{{ msi_arguments | list }}"
        state: present
      when: ( windows_package_path is defined and action_triggered == "install" ) or
        ( windows_package_path is defined and action_triggered == "reinstall" )
